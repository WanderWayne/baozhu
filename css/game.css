/* æ¸¸æˆç•Œé¢æ ·å¼ V2 - å¯è§†åŒ–ç›®æ ‡é—¨ */
:root {
    --bg-color: #F9F7F2; /* æ›´æ¸©æš–çš„ç±³è‰² */
    --brand-color: #D4A574;
    --brand-color-light: #E8D5C4;
    --text-color: #5A4A42; /* æ·±æ£•è‰²æ–‡å­—ï¼Œæ¯”çº¯ç°æ›´æŸ”å’Œ */
    --text-light: #9C8C74;
    
    /* ç‰©å“ç±»å‹é¢œè‰² - æŸ”å’Œçš„è«å…°è¿ªè‰²ç³» */
    --color-base: #F5F5F5;
    --color-floral: #FFF0F5; /* æµ…ç²‰ */
    --color-fruit: #F0FFF4; /* æµ…ç»¿/æœè‰² */
    --color-grain: #FFF8E1; /* æµ…é»„ */
    --color-special: #E3F2FD; /* æµ…è“ */
    --color-mid: #F3E5F5; /* æµ…ç´« */
    --color-final: #FFF3E0; /* æ©™é»„ */
    --color-ultimate: #FFFDE7; /* é‡‘äº® */
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
    background: var(--bg-color);
    overflow: hidden;
    touch-action: manipulation;
    /* æ›´æŸ”å’Œçš„å…¨å±€çº¹ç† - å¥¶é›¾æ„Ÿ */
    background-image: radial-gradient(rgba(212, 165, 116, 0.06) 1.5px, transparent 1.5px);
    background-size: 35px 35px;
    background-color: var(--bg-color);
}

/* ========== å¥¶é›¾ç²’å­èƒŒæ™¯å±‚ ========== */
.milk-fog-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
    overflow: hidden;
}

.milk-fog-particle {
    position: absolute;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(255, 252, 245, 0.4) 0%, transparent 70%);
    animation: milkFogFloat 6s ease-in-out infinite;
}

.milk-fog-particle:nth-child(1) { width: 80px; height: 80px; left: 10%; top: 20%; animation-delay: 0s; }
.milk-fog-particle:nth-child(2) { width: 120px; height: 120px; left: 70%; top: 15%; animation-delay: -1.5s; }
.milk-fog-particle:nth-child(3) { width: 60px; height: 60px; left: 30%; top: 50%; animation-delay: -3s; }
.milk-fog-particle:nth-child(4) { width: 100px; height: 100px; left: 80%; top: 60%; animation-delay: -4.5s; }
.milk-fog-particle:nth-child(5) { width: 70px; height: 70px; left: 15%; top: 75%; animation-delay: -2s; }
.milk-fog-particle:nth-child(6) { width: 90px; height: 90px; left: 55%; top: 35%; animation-delay: -5s; }
.milk-fog-particle:nth-child(7) { width: 50px; height: 50px; left: 45%; top: 80%; animation-delay: -1s; }
.milk-fog-particle:nth-child(8) { width: 110px; height: 110px; left: 85%; top: 40%; animation-delay: -3.5s; }

@keyframes milkFogFloat {
    0%, 100% {
        transform: translateY(0) scale(1);
        opacity: 0.04;
    }
    50% {
        transform: translateY(-8px) scale(1.05);
        opacity: 0.06;
    }
}

/* ========== ç³–æ™¶å¾®é—ªç²’å­ ========== */
.sugar-sparkle {
    position: fixed;
    pointer-events: none;
    z-index: 100;
    background: radial-gradient(circle, 
        rgba(255, 255, 255, 1) 0%, 
        rgba(255, 220, 180, 0.9) 30%,
        rgba(212, 165, 116, 0.5) 60%, 
        transparent 80%);
    border-radius: 50%;
    box-shadow: 
        0 0 6px 2px rgba(255, 255, 255, 0.8),
        0 0 12px 4px rgba(255, 220, 180, 0.5);
    animation: sugarSparkle 2.5s ease-out forwards;
}

.sugar-sparkle::before {
    content: 'âœ¦';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 8px;
    color: rgba(255, 255, 255, 0.9);
    text-shadow: 0 0 4px rgba(255, 220, 180, 0.8);
}

@keyframes sugarSparkle {
    0% {
        opacity: 0;
        transform: scale(0.3);
    }
    10% {
        opacity: 1;
        transform: scale(1.3);
    }
    30% {
        opacity: 1;
        transform: scale(1);
    }
    50% {
        opacity: 0.9;
        transform: scale(1.1);
    }
    70% {
        opacity: 0.6;
        transform: scale(0.9);
    }
    100% {
        opacity: 0;
        transform: scale(0.2);
    }
}

/* ========== é¡¶éƒ¨ç›®æ ‡é—¨åŒºåŸŸ (Moon Gate Style) ========== */
#door-area {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 28vh; /* ç¨å¾®å¢åŠ é«˜åº¦ä»¥å®¹çº³æ›´å¤§çš„é—¨ */
    min-height: 180px;
    background: linear-gradient(180deg, rgba(232, 224, 208, 0.4) 0%, rgba(249, 247, 242, 0) 100%);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 5;
    padding: 10px;
    /* æŸ”å’Œçš„å…‰æ™• */
    box-shadow: 0 10px 30px rgba(212, 165, 116, 0.1);
}

/* è¿”å›æŒ‰é’® - ç²¾è‡´åœ†å½¢æ ·å¼ */
.back-btn {
    position: absolute;
    top: 20px;
    left: 20px;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(4px);
    border: 1px solid rgba(212, 165, 116, 0.3);
    border-radius: 50%;
    
    display: flex;
    align-items: center;
    justify-content: center;
    
    font-size: 20px;
    color: var(--brand-color);
    cursor: pointer;
    z-index: 20;
    box-shadow: 0 4px 10px rgba(139, 115, 85, 0.1);
    transition: all 0.2s ease;
    padding: 0;
}

.back-btn:active {
    transform: scale(0.9);
    background: rgba(255, 255, 255, 0.95);
    box-shadow: 0 2px 5px rgba(139, 115, 85, 0.15);
}

/* èº«ä»½é“­ç‰Œ */
.identity-plaque {
    position: absolute;
    top: 20px;
    right: 20px;
    display: flex;
    align-items: center;
    gap: 6px;
    
    background: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(4px);
    padding: 6px 14px;
    border-radius: 20px;
    border: 1px solid rgba(212, 165, 116, 0.3);
    box-shadow: 0 4px 10px rgba(139, 115, 85, 0.1);
    
    z-index: 20;
    transition: all 0.3s ease;
}

.identity-icon {
    font-size: 14px;
}

.identity-title {
    font-size: 11px;
    font-weight: 600;
    color: var(--brand-color);
    letter-spacing: 1px;
}

/* ä¸åŒç­‰çº§çš„èº«ä»½é“­ç‰Œæ ·å¼ */
.identity-plaque.level-apprentice {
    border-color: rgba(139, 115, 85, 0.3);
}

.identity-plaque.level-brewer {
    border-color: rgba(212, 165, 116, 0.5);
    background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,248,225,0.9) 100%);
}

.identity-plaque.level-master {
    border-color: rgba(255, 215, 0, 0.5);
    background: linear-gradient(135deg, rgba(255,253,245,0.95) 0%, rgba(255,236,179,0.95) 100%);
    box-shadow: 0 4px 15px rgba(255, 215, 0, 0.2);
}

.identity-plaque.level-legend {
    border-color: rgba(255, 215, 0, 0.8);
    background: linear-gradient(135deg, #FFF8E1 0%, #FFD54F 100%);
    box-shadow: 0 4px 20px rgba(255, 215, 0, 0.4);
}

.identity-plaque.level-legend .identity-title {
    color: #7B5800;
}

.door-container {
    position: relative;
    width: 100px;
    height: 150px; /* æ‹±é—¨å½¢çŠ¶ - é«˜å¤§äºå®½ */
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 15px;
    margin-top: 10px;
    transition: transform 0.5s ease;
}

/* é—¨æ¡† - æ‹±é—¨é£æ ¼ï¼ˆä¸å¼€åœºåŠ¨ç”»ä¸€è‡´ï¼‰ */
.door-frame {
    width: 100%;
    height: 100%;
    border-radius: 50px 50px 0 0; /* æ‹±é—¨é¡¶éƒ¨åœ†å¼§ */
    background: transparent;
    border: 3px solid rgba(150, 150, 150, 0.6);
    box-sizing: border-box;
    position: relative;
    overflow: hidden;
    transition: all 0.5s ease;
    z-index: 2;
}

/* å†…éƒ¨ç©ºé—´ - é»‘è‰² + å¾®å¼±è§å…‰è“ + å‘¼å¸åŠ¨ç”» */
.door-glow {
    position: absolute;
    top: 6px;
    left: 6px;
    right: 6px;
    bottom: 0;
    border-radius: 44px 44px 0 0;
    background: linear-gradient(180deg, #0a0a0a 0%, #050508 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.5s ease;
    overflow: hidden;
    box-shadow: inset 0 0 30px rgba(0, 180, 200, 0.15);
    animation: doorGlowBreath 6s ease-in-out infinite;
}

@keyframes doorGlowBreath {
    0%, 100% {
        box-shadow: inset 0 0 30px rgba(0, 180, 200, 0.12);
    }
    50% {
        box-shadow: inset 0 0 45px rgba(0, 180, 200, 0.2);
    }
}

/* å†…éƒ¨å¾®å…‰æ•ˆæœ */
.door-glow::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: radial-gradient(ellipse at center 30%, rgba(0, 200, 220, 0.1) 0%, transparent 60%);
    opacity: 0.5;
    pointer-events: none;
    transition: opacity 0.5s;
    animation: doorGlowPulse 7s ease-in-out infinite;
}

@keyframes doorGlowPulse {
    0%, 100% {
        opacity: 0.4;
        transform: scale(1);
    }
    50% {
        opacity: 0.6;
        transform: scale(1.05);
    }
}

/* æ¶²æ€æµåŠ¨æ„Ÿï¼ˆè¶…ä½å¯¹æ¯”åº¦ï¼Œéšçº¦å¯è§ï¼‰ */
.door-glow::after {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: 
        radial-gradient(ellipse at 30% 40%, rgba(200, 230, 255, 0.03) 0%, transparent 40%),
        radial-gradient(ellipse at 70% 60%, rgba(180, 220, 240, 0.02) 0%, transparent 35%);
    animation: liquidFlow 12s ease-in-out infinite;
    pointer-events: none;
}

@keyframes liquidFlow {
    0%, 100% {
        transform: translate(0, 0) rotate(0deg);
    }
    33% {
        transform: translate(5%, 3%) rotate(2deg);
    }
    66% {
        transform: translate(-3%, 5%) rotate(-1deg);
    }
}

/* ç›®æ ‡ç‰©å“ - å‘¼å¸åŠ¨ç”» */
.door-target-silhouette {
    font-size: 48px;
    opacity: 0.3; /* åˆå§‹æš—æ·¡ */
    filter: blur(4px) grayscale(80%);
    transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
    z-index: 3;
    transform: scale(0.9);
    position: relative;
    animation: targetBreath 2.5s ease-in-out infinite;
}

@keyframes targetBreath {
    0%, 100% { 
        transform: scale(0.9); 
        filter: blur(4px) grayscale(80%);
    }
    50% { 
        transform: scale(0.95); 
        filter: blur(3px) grayscale(70%);
    }
}

/* é—¨çš„çŠ¶æ€å…‰ç¯ */
.door-aura {
    position: absolute;
    top: -8px; left: -8px; right: -8px; bottom: -8px;
    border-radius: 58px 58px 0 0;
    border: 2px solid transparent;
    transition: all 0.8s ease;
    pointer-events: none;
    z-index: 1;
}

/* ========== é—¨çš„ä¸‰é˜¶æ®µçŠ¶æ€ ========== */

/* è‡ªç”±æ¨¡å¼é—¨æ ·å¼ */
.door-container.free-mode .door-frame {
    border-color: #9C88FF;
    box-shadow: 0 0 20px rgba(156, 136, 255, 0.3);
}

.door-container.free-mode .door-glow {
    background: linear-gradient(135deg, #2C2440 0%, #1A1525 100%);
}

.door-container.free-mode .door-target-silhouette {
    opacity: 1;
    filter: none;
    transform: scale(1);
    animation: freeModePulse 2s ease-in-out infinite;
}

@keyframes freeModePulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

.door-container.free-mode .door-aura {
    border-color: rgba(156, 136, 255, 0.4);
    animation: freeModeAura 3s ease-in-out infinite;
}

@keyframes freeModeAura {
    0%, 100% { transform: scale(1); opacity: 0.5; }
    50% { transform: scale(1.1); opacity: 0.8; }
}

/* Stage 0: æ²‰ç¡ - æš—æ·¡çŠ¶æ€ */
.door-container.stage-0 .door-target-silhouette {
    opacity: 0.2;
    filter: blur(8px) grayscale(100%);
    animation: targetBreath 3s ease-in-out infinite;
}

/* Stage 1: å”¤é†’ (å¾®å…‰) - è§å…‰è“å¼€å§‹æ˜¾ç° */
.door-container.stage-1 .door-frame {
    border-color: rgba(0, 180, 200, 0.5);
    box-shadow: 0 0 15px rgba(0, 180, 200, 0.2);
}
.door-container.stage-1 .door-glow {
    box-shadow: inset 0 0 40px rgba(0, 200, 220, 0.25);
}
.door-container.stage-1 .door-glow::before {
    opacity: 0.7;
}
.door-container.stage-1 .door-target-silhouette {
    opacity: 0.5;
    filter: blur(3px) grayscale(60%);
    transform: scale(0.95);
    animation: targetBreathStage1 2.5s ease-in-out infinite;
}
@keyframes targetBreathStage1 {
    0%, 100% { transform: scale(0.95); opacity: 0.5; }
    50% { transform: scale(1); opacity: 0.6; }
}
.door-container.stage-1 .door-aura {
    border-color: rgba(0, 180, 200, 0.3);
    transform: scale(1.02);
}

/* Stage 2: è„‰åŠ¨ (å³å°†å¼€å¯) - è§å…‰è“æ›´å¼º */
.door-container.stage-2 .door-frame {
    border-color: rgba(0, 220, 255, 0.7);
    box-shadow: 0 0 25px rgba(0, 220, 255, 0.4);
}
.door-container.stage-2 .door-glow {
    box-shadow: inset 0 0 50px rgba(0, 220, 255, 0.35);
    animation: glowPulse 2s infinite;
}
.door-container.stage-2 .door-glow::before {
    opacity: 1;
    background: radial-gradient(ellipse at center 30%, rgba(0, 220, 255, 0.2) 0%, transparent 60%);
}
.door-container.stage-2 .door-target-silhouette {
    opacity: 0.8;
    filter: blur(1px) grayscale(20%);
    transform: scale(1);
    text-shadow: 0 0 20px rgba(0, 220, 255, 0.6);
    animation: targetBreathStage2 2s ease-in-out infinite;
}
@keyframes targetBreathStage2 {
    0%, 100% { transform: scale(1); opacity: 0.8; }
    50% { transform: scale(1.05); opacity: 0.9; }
}
.door-container.stage-2 .door-aura {
    border-color: rgba(0, 220, 255, 0.5);
    box-shadow: 0 0 30px rgba(0, 220, 255, 0.3);
    animation: auraGlow 2s ease-in-out infinite;
}
@keyframes auraGlow {
    0%, 100% { opacity: 0.5; }
    50% { opacity: 0.8; }
}

/* Stage 3: å¼€å¯ (é«˜æ½®) - å……æ»¡å…‰èŠ’ */
.door-container.stage-3 {
    transform: scale(1.05);
}
.door-container.stage-3 .door-frame {
    border-color: rgba(255, 255, 255, 0.9);
    box-shadow: 0 0 40px rgba(0, 220, 255, 0.8), 0 0 60px rgba(255, 255, 255, 0.4);
    background: transparent;
}
.door-container.stage-3 .door-glow {
    background: radial-gradient(ellipse at center, rgba(0, 220, 255, 0.3) 0%, rgba(10, 10, 10, 0.9) 70%);
    box-shadow: inset 0 0 60px rgba(0, 220, 255, 0.5);
}
.door-container.stage-3 .door-glow::before {
    opacity: 0;
}
.door-container.stage-3 .door-target-silhouette {
    opacity: 1;
    filter: none;
    transform: scale(1.15);
    text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
    animation: targetBreathStage3 1.5s ease-in-out infinite;
}
@keyframes targetBreathStage3 {
    0%, 100% { transform: scale(1.15); }
    50% { transform: scale(1.2); }
}
.door-container.stage-3 .door-aura {
    border-color: rgba(255, 255, 255, 0.6);
    box-shadow: 0 0 50px rgba(0, 220, 255, 0.5);
    animation: auraGlowIntense 1.5s ease-in-out infinite;
}
@keyframes auraGlowIntense {
    0%, 100% { opacity: 0.6; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.03); }
}

/* é—¨ç­‰å¾…çŒ®ä¸ŠçŠ¶æ€ - stage-3 æ—¶æç¤ºç©å®¶ */
.door-container.stage-3.awaiting-offer .door-frame {
    animation: awaitingPulse 1.5s ease-in-out infinite;
}

@keyframes awaitingPulse {
    0%, 100% { box-shadow: 0 0 40px rgba(0, 220, 255, 0.8), 0 0 60px rgba(255, 255, 255, 0.4); }
    50% { box-shadow: 0 0 60px rgba(0, 220, 255, 1), 0 0 80px rgba(255, 255, 255, 0.6); }
}

/* é—¨é è¿‘åé¦ˆ - æ‹–ç€ç‰©å“é è¿‘é—¨æ—¶ */
.door-container.door-nearby {
    transform: scale(1.05);
}

.door-container.door-nearby .door-frame {
    border-color: rgba(0, 220, 255, 0.8);
    box-shadow: 0 0 35px rgba(0, 220, 255, 0.6);
}

.door-container.door-nearby .door-glow {
    box-shadow: inset 0 0 40px rgba(0, 220, 255, 0.4);
}

.door-container.door-nearby .door-aura {
    border-color: rgba(0, 220, 255, 0.6);
    animation: nearbyAura 0.8s ease-in-out infinite;
}

@keyframes nearbyAura {
    0%, 100% { transform: scale(1); opacity: 0.6; }
    50% { transform: scale(1.05); opacity: 1; }
}

/* çŒ®ä¸Šæç¤ºæ–‡å­— */
.door-offer-hint {
    position: absolute;
    bottom: -30px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(212, 165, 116, 0.95);
    color: white;
    padding: 6px 16px;
    border-radius: 15px;
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 1px;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
    box-shadow: 0 4px 12px rgba(212, 165, 116, 0.4);
}

.door-container.door-nearby .door-offer-hint {
    opacity: 1;
}

/* çŒ®ä¸ŠæˆåŠŸåŠ¨ç”» */
.door-container.offering .door-frame {
    animation: offeringFlash 0.6s ease-out;
}

@keyframes offeringFlash {
    0% { transform: scale(1); }
    30% { transform: scale(1.2); box-shadow: 0 0 80px rgba(255, 215, 0, 1); }
    100% { transform: scale(1); }
}

/* è¢«çŒ®ä¸Šçš„ç‰©å“æ¶ˆå¤±åŠ¨ç”» */
.game-item.offering-item {
    animation: itemTowardsDoor 0.5s ease-out forwards;
    pointer-events: none;
}

@keyframes itemTowardsDoor {
    0% { transform: scale(1); opacity: 1; }
    100% { transform: scale(0.3) translateY(-100px); opacity: 0; }
}

@keyframes glowPulse {
    0% { box-shadow: inset 0 0 10px rgba(212, 165, 116, 0.2); }
    50% { box-shadow: inset 0 0 30px rgba(212, 165, 116, 0.6); }
    100% { box-shadow: inset 0 0 10px rgba(212, 165, 116, 0.2); }
}

@keyframes auraRotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* é›¾æ°”åŠ¨ç”» */
.door-fog {
    position: absolute;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, transparent 40%, rgba(255,255,255,0.1) 60%);
    animation: rotateFog 10s linear infinite;
    pointer-events: none;
    z-index: 2;
}

@keyframes rotateFog {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* å…³å¡ä¿¡æ¯ */
.level-info {
    text-align: center;
    margin-top: 5px;
    z-index: 10;
}

.level-name {
    font-size: 14px;
    font-weight: 500;
    color: var(--text-color);
}

.level-target-text {
    font-size: 12px;
    color: var(--text-light);
    margin-top: 2px;
}

/* é—¨çŠ¶æ€æç¤º - ç²¾è‡´èƒ¶å›Šé£æ ¼ */
.door-status {
    position: absolute;
    bottom: 15px;
    left: 50%;
    transform: translateX(-50%) translateY(10px);
    
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(8px);
    border: 1px solid var(--brand-color);
    padding: 8px 20px;
    border-radius: 20px;
    
    font-size: 13px;
    font-weight: 600;
    color: var(--brand-color);
    
    opacity: 0;
    transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    white-space: nowrap;
    box-shadow: 0 4px 15px rgba(212, 165, 116, 0.25);
    pointer-events: none;
    z-index: 10;
}

.door-status.visible {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
}

/* ========== åˆæˆå·¥ä½œå°åŒºåŸŸ ========== */
#synthesis-area {
    position: absolute;
    top: 25vh;
    bottom: 20vh;
    left: 0;
    right: 0;
    min-height: 300px;
    /* æ›´åŠ æŸ”å’Œçš„æœ¨çº¹/çº¸è´¨è´¨æ„Ÿ */
    background-color: var(--bg-color);
    background-image: 
        linear-gradient(rgba(212, 165, 116, 0.1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(212, 165, 116, 0.1) 1px, transparent 1px);
    background-size: 40px 40px;
    overflow: hidden;
    touch-action: none;
}

/* å·¥ä½œå°è£…é¥° - ä¸­å¿ƒèšç„¦æ„Ÿ */
.workbench-texture {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at center, rgba(255,255,255,0.8) 0%, rgba(249, 247, 242, 0) 70%);
    pointer-events: none;
}

/* æ”¾ç½®å¼•å¯¼ç‚¹ï¼ˆè§†è§‰è£…é¥°ï¼‰ */
#synthesis-area::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 200px;
    height: 200px;
    border: 2px dashed rgba(212, 165, 116, 0.2);
    border-radius: 50%;
    pointer-events: none;
    opacity: 0.5;
}

/* ========== åº•éƒ¨åŸæ–™å¸¦ ========== */
#inventory-area {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 20vh;
    min-height: 140px;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px); /* æ¯›ç»ç’ƒæ•ˆæœ */
    box-shadow: 0 -4px 30px rgba(0,0,0,0.05);
    padding: 15px 20px;
    display: flex;
    align-items: center;
    overflow-x: auto;
    gap: 20px;
    z-index: 20;
    /* å¢åŠ é¡¶éƒ¨è¾¹æ¡†è£…é¥° */
    border-top: 1px solid rgba(212, 165, 116, 0.2);
}

#inventory-area::-webkit-scrollbar {
    height: 4px;
}

#inventory-area::-webkit-scrollbar-track {
    background: transparent;
}

#inventory-area::-webkit-scrollbar-thumb {
    background: var(--brand-color-light);
    border-radius: 4px;
}

/* ========== æ¸¸æˆå…ƒç´  ========== */
.game-item {
    width: 90px;
    height: 90px;
    background: white;
    border-radius: 50%; /* æ”¹ä¸ºåœ†å½¢ï¼Œæ›´æŸ”å’Œ */
    box-shadow: 0 6px 16px rgba(139, 115, 85, 0.15); /* æ›´æš–çš„é˜´å½± */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    user-select: none;
    cursor: grab;
    position: absolute;
    transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s, border-color 0.2s;
    border: 3px solid white; /* å†…æè¾¹ */
    z-index: 5;
    touch-action: none;
    overflow: hidden; /* ç¡®ä¿å†…å®¹ä¸æº¢å‡ºåœ†å½¢ */
}

/* ç±»å‹æ ·å¼ */
.game-item.type-base { background: var(--color-base); }
.game-item.type-floral { background: var(--color-floral); border-color: #FFF0F5; }
.game-item.type-fruit { background: var(--color-fruit); border-color: #F0FFF4; }
.game-item.type-grain { background: var(--color-grain); border-color: #FFF8E1; }
.game-item.type-special { background: var(--color-special); border-color: #E3F2FD; }
.game-item.type-mid { background: var(--color-mid); border-color: #F3E5F5; }
.game-item.type-final { 
    background: var(--color-final); 
    border-color: #FFE0B2;
    box-shadow: 0 8px 20px rgba(255, 167, 38, 0.25);
}
.game-item.type-ultimate { 
    background: var(--color-ultimate); 
    border-color: #FFD54F;
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
}

.game-item.in-inventory {
    position: relative;
    flex-shrink: 0;
    animation: itemBreath 7s ease-in-out infinite;
}

/* ç‰©å“å‘¼å¸åŠ¨ç”» - ç­‰å¾…è¢«ä½¿ç”¨çš„æ„Ÿè§‰ */
@keyframes itemBreath {
    0%, 100% {
        transform: scale(1);
        box-shadow: 0 6px 16px rgba(139, 115, 85, 0.15);
    }
    50% {
        transform: scale(1.1);
        box-shadow: 0 8px 20px rgba(139, 115, 85, 0.18);
    }
}

/* é”™å¼€å‘¼å¸èŠ‚å¥ - æ¯ä¸ªç‰©å“æœ‰ä¸åŒçš„å»¶è¿Ÿ */
.game-item.in-inventory:nth-child(1) { animation-delay: 0s; }
.game-item.in-inventory:nth-child(2) { animation-delay: -1s; }
.game-item.in-inventory:nth-child(3) { animation-delay: -2s; }
.game-item.in-inventory:nth-child(4) { animation-delay: -3s; }
.game-item.in-inventory:nth-child(5) { animation-delay: -4s; }
.game-item.in-inventory:nth-child(6) { animation-delay: -5s; }
.game-item.in-inventory:nth-child(7) { animation-delay: -6s; }
.game-item.in-inventory:nth-child(8) { animation-delay: -0.5s; }
.game-item.in-inventory:nth-child(9) { animation-delay: -1.5s; }
.game-item.in-inventory:nth-child(10) { animation-delay: -2.5s; }

/* æ‹–åŠ¨æ—¶åœæ­¢å‘¼å¸ */
.game-item.dragging,
.game-item:active {
    animation: none !important;
}

.game-item:active {
    cursor: grabbing;
    transform: scale(1.15);
    box-shadow: 0 15px 30px rgba(139, 115, 85, 0.25);
    z-index: 100;
}

.game-item.highlight {
    border-color: var(--brand-color);
    box-shadow: 0 0 0 4px rgba(212, 165, 116, 0.3), 0 8px 20px rgba(139, 115, 85, 0.2);
    transform: scale(1.1);
}

.game-item .icon {
    font-size: 40px;
    margin-bottom: 2px;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.05));
    transition: transform 0.2s;
}

.game-item:active .icon {
    transform: scale(1.1);
}

.game-item .name {
    font-size: 11px;
    color: var(--text-color);
    text-align: center;
    width: 90%;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    padding: 2px 4px;
    background: rgba(255,255,255,0.6);
    border-radius: 8px;
    margin-top: 2px;
}

/* åˆæˆæˆåŠŸç‰¹æ•ˆ - æŸ”å’Œå¥¶æ„Ÿ */
@keyframes synthesisSuccess {
    0% { 
        transform: scale(0.8) translateY(3px); 
        box-shadow: 0 0 0 0 rgba(255, 250, 240, 0.3);
        opacity: 0.7;
    }
    30% { 
        transform: scale(1.08) translateY(-2px); 
        box-shadow: 0 8px 25px rgba(212, 165, 116, 0.25);
        opacity: 1;
    }
    100% { 
        transform: scale(1) translateY(0); 
        box-shadow: 0 6px 16px rgba(139, 115, 85, 0.15);
        opacity: 1;
    }
}

.synthesis-anim {
    animation: synthesisSuccess 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* åˆæˆæŸ”æ³¢çº¹æ•ˆæœ */
.synthesis-ripple {
    position: absolute;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(255, 252, 245, 0.4) 0%, rgba(255, 250, 240, 0.1) 50%, transparent 70%);
    pointer-events: none;
    animation: synthesisRipple 0.8s ease-out forwards;
}

@keyframes synthesisRipple {
    0% {
        width: 20px;
        height: 20px;
        opacity: 0.6;
        transform: translate(-50%, -50%) scale(0.5);
    }
    100% {
        width: 120px;
        height: 120px;
        opacity: 0;
        transform: translate(-50%, -50%) scale(1);
    }
}

/* å¤±è´¥ç‰¹æ•ˆ */
@keyframes shake {
    0%, 100% { transform: translateX(0); }
    10%, 30%, 50%, 70%, 90% { transform: translateX(-4px); }
    20%, 40%, 60%, 80% { transform: translateX(4px); }
}

.shake-anim {
    animation: shake 0.4s ease-in-out;
    border-color: #ff8a80 !important;
}

/* ç²’å­ç‰¹æ•ˆå®¹å™¨ */
.particle-container {
    position: absolute;
    pointer-events: none;
    z-index: 1000;
}

/* å¥¶é…ªç ç²’å­ - åœ†æ¶¦å°çƒï¼Œç¼“æ…¢å‘ä¸Šæ¼‚æµ® */
.particle {
    position: absolute;
    background: radial-gradient(circle at 30% 30%, 
        rgba(255, 252, 245, 0.95) 0%, 
        rgba(255, 248, 230, 0.8) 40%,
        rgba(240, 230, 210, 0.6) 100%);
    border-radius: 50%;
    box-shadow: 
        0 2px 4px rgba(139, 115, 85, 0.15),
        inset 0 -2px 4px rgba(212, 165, 116, 0.1);
    animation: milkBallFloat 1.5s ease-out forwards;
}

@keyframes milkBallFloat {
    0% { 
        transform: translate(0, 0) scale(0.6); 
        opacity: 0.8; 
    }
    40% {
        transform: translate(var(--tx), calc(var(--ty) * 0.3)) scale(1);
        opacity: 0.9;
    }
    100% { 
        transform: translate(var(--tx), var(--ty)) scale(0.4); 
        opacity: 0; 
    }
}

/* ========== å€’è®¡æ—¶è¦†ç›–å±‚ ========== */
.timer-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255,255,255,0.95);
    border-radius: 16px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 6;
}

.timer-circle {
    width: 36px;
    height: 36px;
    border: 3px solid #eee;
    border-top-color: var(--brand-color);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: 8px;
}

.timer-text {
    font-size: 10px;
    color: var(--text-light);
    text-align: center;
    padding: 0 5px;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* ========== æˆåŠŸå¼¹çª— ========== */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.6);
    z-index: 1000;
    display: flex;
    justify-content: center;
    align-items: center;
    animation: fadeIn 0.3s;
}

.success-modal {
    background: white;
    width: 90%;
    max-width: 340px;
    border-radius: 24px;
    padding: 30px 24px;
    text-align: center;
    animation: scaleIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.success-icon {
    font-size: 72px;
    margin-bottom: 16px;
    display: block;
    animation: bounce 1s infinite;
}

.success-title {
    font-size: 22px;
    color: var(--brand-color);
    margin-bottom: 8px;
    font-weight: 500;
}

.success-subtitle {
    font-size: 14px;
    color: var(--text-color);
    margin-bottom: 16px;
}

.success-desc {
    font-size: 14px;
    color: var(--text-light);
    line-height: 1.6;
    margin-bottom: 16px;
}

.culture-note {
    background: #FAF8F3;
    padding: 12px 16px;
    border-radius: 12px;
    font-size: 13px;
    color: var(--text-color);
    margin-bottom: 16px;
    font-style: italic;
    line-height: 1.6;
    text-align: left;
}

.real-product {
    background: linear-gradient(135deg, #FFF5E6 0%, #FFE4D4 100%);
    padding: 12px 16px;
    border-radius: 12px;
    font-size: 12px;
    color: var(--text-color);
    margin-bottom: 20px;
    text-align: left;
    line-height: 1.5;
}

.real-product::before {
    content: 'ğŸª ';
}

/* æˆå°±å¾½ç«  */
.achievement-badge {
    background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
    padding: 12px 16px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 16px;
    animation: badgeSlide 0.5s ease-out;
}

.achievement-badge.new {
    box-shadow: 0 4px 20px rgba(255, 215, 0, 0.4);
}

.badge-icon {
    font-size: 32px;
    animation: badgeBounce 0.6s ease-out 0.3s;
}

.badge-info {
    text-align: left;
}

.badge-title {
    font-size: 11px;
    color: rgba(255, 255, 255, 0.9);
    margin-bottom: 2px;
}

.badge-name {
    font-size: 15px;
    font-weight: 600;
    color: white;
}

@keyframes badgeSlide {
    from {
        transform: translateX(-20px);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

@keyframes badgeBounce {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.2); }
}

/* è¿‡æ¸¡æ–‡æ¡ˆ */
.transition-text {
    font-size: 13px;
    color: var(--brand-color);
    font-style: italic;
    margin-bottom: 16px;
    padding: 8px 0;
    border-top: 1px dashed var(--brand-color-light);
    border-bottom: 1px dashed var(--brand-color-light);
}

.modal-buttons {
    display: flex;
    gap: 12px;
    justify-content: center;
}

.modal-btn {
    background: var(--brand-color);
    color: white;
    border: none;
    padding: 14px 28px;
    border-radius: 25px;
    font-size: 15px;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(212, 165, 116, 0.4);
    transition: transform 0.2s, box-shadow 0.2s;
}

.modal-btn:active {
    transform: scale(0.95);
}

.modal-btn.secondary {
    background: #f0f0f0;
    color: var(--text-color);
    box-shadow: none;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes scaleIn {
    from { transform: scale(0.8); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}

@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
}

/* ========== Toast æ¶ˆæ¯æç¤º ========== */
.toast-msg {
    position: fixed;
    top: 30vh; /* ä¸‹ç§»ä»¥é¿å…é®æŒ¡é¡¶éƒ¨ç›®æ ‡ */
    left: 50%;
    transform: translateX(-50%);
    
    /* æ›´åŠ ç²¾è‡´çš„å¡ç‰‡é£æ ¼ */
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(8px);
    border: 1px solid var(--brand-color-light);
    color: var(--text-color);
    box-shadow: 0 8px 24px rgba(139, 115, 85, 0.15);
    
    padding: 12px 24px;
    border-radius: 30px;
    font-size: 14px;
    font-weight: 500;
    letter-spacing: 0.5px;
    
    z-index: 200;
    pointer-events: none;
    animation: toastFloat 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    
    max-width: 80%;
    text-align: center;
    line-height: 1.5;
    
    /* è£…é¥° */
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.toast-msg::before {
    content: 'ğŸ’¡';
    font-size: 16px;
}

@keyframes toastFloat {
    from { 
        transform: translate(-50%, 20px) scale(0.9); 
        opacity: 0; 
    }
    to { 
        transform: translate(-50%, 0) scale(1); 
        opacity: 1; 
    }
}

/* ========== å‘ç°æ–°ç‰©å“æç¤º ========== */
.discovery-toast {
    position: fixed;
    top: 20vh; /* ä¸‹ç§» */
    left: 50%;
    transform: translateX(-50%);
    
    /* æ›´åŠ åä¸½çš„é‡‘è‰²æ¸å˜ */
    background: linear-gradient(135deg, #FFF8E1 0%, #FFE0B2 100%);
    border: 2px solid #FFD54F;
    color: #E65100;
    
    padding: 14px 28px;
    border-radius: 30px;
    font-size: 15px;
    font-weight: 600;
    
    z-index: 200;
    pointer-events: none;
    
    box-shadow: 0 10px 25px rgba(255, 167, 38, 0.3);
    
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden; /* é™åˆ¶å…‰æ•ˆèŒƒå›´ */
    
    animation: discoveryPop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.discovery-toast .icon {
    display: inline-block;
    margin-right: 8px;
    font-size: 24px;
    filter: drop-shadow(0 2px 2px rgba(0,0,0,0.1));
    animation: bounce 1s infinite;
}

/* æ‰«å…‰ç‰¹æ•ˆ */
.discovery-toast::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 50%;
    height: 100%;
    background: linear-gradient(
        120deg, 
        transparent, 
        rgba(255,255,255,0.6), 
        transparent
    );
    transform: skewX(-25deg);
    animation: shimmer 2.5s infinite;
}

@keyframes shimmer {
    0% { left: -100%; }
    40%, 100% { left: 200%; }
}

@keyframes discoveryPop {
    0% { 
        transform: translate(-50%, 30px) scale(0.5); 
        opacity: 0; 
    }
    60% {
        transform: translate(-50%, -10px) scale(1.1);
    }
    100% { 
        transform: translate(-50%, 0) scale(1); 
        opacity: 1; 
    }
}

/* ========== ç§»åŠ¨ç«¯ä¼˜åŒ– ========== */

/* é˜²æ­¢iOSä¸Šçš„æ©¡çš®ç­‹æ•ˆæœ */
html, body {
    overscroll-behavior: none;
    -webkit-overflow-scrolling: touch;
}

/* è§¦æ‘¸æ—¶çš„è§†è§‰åé¦ˆ */
.game-item {
    -webkit-tap-highlight-color: transparent;
}

.game-item:active {
    background: #FAFAFA;
}

/* é˜²æ­¢æ–‡æœ¬é€‰æ‹© */
.game-item, .door-frame, #synthesis-area {
    -webkit-user-select: none;
    user-select: none;
}

/* å¹³æ»‘æ»šåŠ¨ */
#inventory-area {
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth;
}

/* å®‰å…¨åŒºåŸŸé€‚é… (iPhone X åŠä»¥ä¸Š) */
@supports (padding-bottom: env(safe-area-inset-bottom)) {
    #inventory-area {
        padding-bottom: calc(15px + env(safe-area-inset-bottom));
    }
}

/* ========== å“åº”å¼ ========== */

/* å°å±æ‰‹æœº */
@media (max-height: 600px) {
    #door-area {
        height: 22vh;
        min-height: 130px;
    }
    .door-container {
        width: 70px;
        height: 105px;
    }
    .door-frame {
        border-radius: 35px 35px 0 0;
    }
    .door-glow {
        border-radius: 30px 30px 0 0;
    }
    .door-aura {
        border-radius: 43px 43px 0 0;
    }
    .door-target-silhouette {
        font-size: 30px;
    }
    #inventory-area {
        height: 18vh;
        min-height: 110px;
    }
    .game-item {
        width: 70px;
        height: 70px;
    }
    .game-item .icon {
        font-size: 28px;
    }
    .game-item .name {
        font-size: 10px;
    }
}

/* æ™®é€šæ‰‹æœº */
@media (max-height: 700px) and (min-height: 601px) {
    #door-area {
        height: 24vh;
        min-height: 150px;
    }
    .door-container {
        width: 85px;
        height: 128px;
    }
    .door-frame {
        border-radius: 43px 43px 0 0;
    }
    .door-glow {
        border-radius: 38px 38px 0 0;
    }
    .door-aura {
        border-radius: 51px 51px 0 0;
    }
    .door-target-silhouette {
        font-size: 38px;
    }
    #inventory-area {
        height: 18vh;
        min-height: 120px;
    }
    .game-item {
        width: 80px;
        height: 80px;
    }
    .game-item .icon {
        font-size: 32px;
    }
}

/* iPad / å¹³æ¿ */
@media (min-width: 768px) {
    .game-item {
        width: 100px;
        height: 100px;
    }
    .game-item .icon {
        font-size: 44px;
    }
    .game-item .name {
        font-size: 13px;
    }
    #inventory-area {
        gap: 20px;
        padding: 20px 30px;
    }
    .door-container {
        width: 120px;
        height: 180px;
    }
    .door-frame {
        border-radius: 60px 60px 0 0;
    }
    .door-glow {
        border-radius: 54px 54px 0 0;
    }
    .door-aura {
        border-radius: 68px 68px 0 0;
    }
    .door-target-silhouette {
        font-size: 52px;
    }
    .success-modal {
        max-width: 400px;
        padding: 40px 30px;
    }
}

/* æ¨ªå±æç¤ºï¼ˆå¯é€‰ï¼‰ */
@media (orientation: landscape) and (max-height: 500px) {
    body::before {
        content: 'è¯·æ—‹è½¬è®¾å¤‡è‡³ç«–å±æ¨¡å¼';
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: var(--bg-color);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        color: var(--text-color);
        z-index: 9999;
    }
}

/* ========== ç¬¬ä¸€å…³æ•™å­¦åŠ¨ç”» ========== */
.tutorial-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(ellipse at center, #1a1a2e 0%, #0d0d15 100%);
    z-index: 10000;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    opacity: 1;
    transition: opacity 0.8s ease;
}

.tutorial-overlay.hidden {
    display: none;
}

.tutorial-overlay.fade-out {
    opacity: 0;
    pointer-events: none;
}

.tutorial-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 30px;
    animation: tutorialFadeIn 1s ease forwards;
}

@keyframes tutorialFadeIn {
    from { opacity: 0; transform: scale(0.9); }
    to { opacity: 1; transform: scale(1); }
}

/* é—¨ç‰¹å†™åŒºåŸŸ - ä¸æ¸¸æˆä¸­çš„é—¨ä¿æŒä¸€è‡´ */
.tutorial-door-spotlight {
    position: relative;
    width: 200px;
    height: 200px;
    animation: tutorialDoorPulse 3s ease-in-out infinite;
}

@keyframes tutorialDoorPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}

.tutorial-door-container {
    width: 100%;
    height: 100%;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* å…‰ç¯ - ä¸æ¸¸æˆä¸­ .door-aura ä¸€è‡´ */
.tutorial-door-aura {
    position: absolute;
    top: -15px; 
    left: -15px; 
    right: -15px; 
    bottom: -15px;
    border-radius: 50%;
    border: 2px solid rgba(212, 165, 116, 0.3);
    animation: tutorialAuraPulse 2s ease-in-out infinite;
    pointer-events: none;
}

@keyframes tutorialAuraPulse {
    0%, 100% { opacity: 0.5; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.05); }
}

/* é—¨æ¡† - ä¸æ¸¸æˆä¸­ .door-frame ä¸€è‡´ï¼ˆä¸­å¼æœˆæ´é—¨é£æ ¼ï¼‰ */
.tutorial-door-frame {
    width: 180px;
    height: 180px;
    border-radius: 50%;
    /* æœ¨è´¨çº¹ç†æ„Ÿ - ä¸æ¸¸æˆä¸€è‡´ */
    background: #8B7355; 
    border: 5px solid #6F5A40;
    box-shadow: 
        0 4px 10px rgba(0,0,0,0.2),
        inset 0 4px 10px rgba(0,0,0,0.3),
        0 0 40px rgba(212, 165, 116, 0.3);
    position: relative;
    overflow: hidden;
    z-index: 2;
}

/* å†…éƒ¨ç©ºé—´ - ä¸æ¸¸æˆä¸­ .door-glow ä¸€è‡´ */
.tutorial-door-glow {
    position: absolute;
    top: 8px;
    left: 8px;
    right: 8px;
    bottom: 8px;
    border-radius: 50%;
    background: #2C241E; /* æ·±é‚ƒå†…éƒ¨ - ä¸æ¸¸æˆä¸€è‡´ */
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
}

/* çª—æ£‚çº¹ç† - ä¸æ¸¸æˆä¸­ .door-glow::before ä¸€è‡´ */
.tutorial-door-glow::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background-image: 
        linear-gradient(45deg, rgba(255,255,255,0.05) 25%, transparent 25%, transparent 75%, rgba(255,255,255,0.05) 75%),
        linear-gradient(45deg, rgba(255,255,255,0.05) 25%, transparent 25%, transparent 75%, rgba(255,255,255,0.05) 75%);
    background-size: 20px 20px;
    background-position: 0 0, 10px 10px;
    opacity: 0.3;
    pointer-events: none;
}

/* é›¾æ°”æ•ˆæœ */
.tutorial-door-fog {
    position: absolute;
    width: 200%;
    height: 200%;
    background: 
        radial-gradient(ellipse at 30% 30%, rgba(212, 165, 116, 0.15) 0%, transparent 50%),
        radial-gradient(ellipse at 70% 60%, rgba(212, 165, 116, 0.1) 0%, transparent 40%);
    animation: tutorialFogDrift 8s ease-in-out infinite;
    z-index: 1;
}

@keyframes tutorialFogDrift {
    0%, 100% { transform: translate(-10%, -10%) rotate(0deg); }
    50% { transform: translate(10%, 10%) rotate(180deg); }
}

/* ç›®æ ‡å›¾æ ‡ - ä¸æ¸¸æˆä¸­ .door-target-silhouette ä¸€è‡´ */
.tutorial-door-icon {
    font-size: 72px;
    opacity: 0.3; /* åˆå§‹éå¸¸æš— - ä¸æ¸¸æˆstage-0ä¸€è‡´ */
    filter: blur(10px) grayscale(100%);
    z-index: 3;
    transform: scale(0.8);
    position: relative;
    animation: tutorialIconFlicker 4s ease-in-out infinite;
}

@keyframes tutorialIconFlicker {
    0%, 100% { opacity: 0.4; filter: blur(4px) brightness(0.5); }
    50% { opacity: 0.6; filter: blur(2px) brightness(0.7); }
}

/* æ•™å­¦æ–‡å­— */
.tutorial-text-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 16px;
}

.tutorial-text {
    color: #fff;
    text-align: center;
    opacity: 0;
    transform: translateY(20px);
}

.tutorial-text-1 {
    font-size: 28px;
    font-weight: 600;
    letter-spacing: 4px;
    text-shadow: 0 0 20px rgba(212, 165, 116, 0.5);
    animation: tutorialTextIn 0.8s ease 0.5s forwards;
}

.tutorial-text-2 {
    font-size: 16px;
    color: rgba(255, 255, 255, 0.8);
    display: flex;
    align-items: center;
    gap: 8px;
    animation: tutorialTextIn 0.8s ease 1.2s forwards;
}

.tutorial-text-2 .highlight {
    color: var(--brand-color);
    font-weight: 600;
    padding: 2px 8px;
    background: rgba(212, 165, 116, 0.2);
    border-radius: 4px;
}

.tutorial-hint-icon {
    font-size: 20px;
    animation: tutorialHintBounce 1s ease-in-out infinite;
}

@keyframes tutorialHintBounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-4px); }
}

@keyframes tutorialTextIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

/* è·³è¿‡/ç»§ç»­æŒ‰é’® */
.tutorial-skip-btn {
    margin-top: 40px;
    padding: 14px 40px;
    background: transparent;
    border: 1px solid rgba(212, 165, 116, 0.5);
    color: rgba(255, 255, 255, 0.8);
    font-size: 14px;
    letter-spacing: 2px;
    border-radius: 30px;
    cursor: pointer;
    opacity: 0;
    animation: tutorialBtnIn 0.8s ease 2s forwards;
    transition: all 0.3s ease;
}

.tutorial-skip-btn:hover {
    background: rgba(212, 165, 116, 0.2);
    border-color: var(--brand-color);
    color: #fff;
    transform: scale(1.05);
}

.tutorial-skip-btn:active {
    transform: scale(0.98);
}

@keyframes tutorialBtnIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* ç”»é¢æ‹‰å¼€åŠ¨ç”» */
.tutorial-overlay.zoom-out .tutorial-content {
    animation: tutorialZoomOut 1s ease forwards;
}

@keyframes tutorialZoomOut {
    0% { 
        opacity: 1; 
        transform: scale(1); 
    }
    100% { 
        opacity: 0; 
        transform: scale(0.3) translateY(-50vh); 
    }
}

/* ========== ç¢ç‰‡å‘ç°å¼¹çª— ========== */
.fragment-discovery-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.fragment-discovery-modal.visible {
    opacity: 1;
}

.fragment-discovery-content {
    width: 85%;
    max-width: 320px;
    background: linear-gradient(180deg, #FFFDF8 0%, #FFF8F0 100%);
    border-radius: 24px;
    padding: 28px 24px;
    text-align: center;
    transform: scale(0.8) translateY(30px);
    transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.3),
        0 0 0 4px rgba(212, 165, 116, 0.3);
}

.fragment-discovery-modal.visible .fragment-discovery-content {
    transform: scale(1) translateY(0);
}

.discovery-header {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-bottom: 20px;
}

.discovery-star {
    font-size: 24px;
    animation: starPulse 1s ease-in-out infinite;
}

@keyframes starPulse {
    0%, 100% { transform: scale(1) rotate(0deg); }
    50% { transform: scale(1.2) rotate(10deg); }
}

.discovery-title {
    font-size: 22px;
    font-weight: 600;
    color: var(--brand-color);
    letter-spacing: 2px;
}

.discovery-item {
    margin-bottom: 24px;
}

.discovery-item .item-icon {
    font-size: 64px;
    margin-bottom: 8px;
    animation: itemBounce 0.6s ease-out;
}

@keyframes itemBounce {
    0% { transform: scale(0); }
    50% { transform: scale(1.2); }
    100% { transform: scale(1); }
}

.discovery-item .item-name {
    font-size: 18px;
    font-weight: 600;
    color: var(--text-color);
}

.fragment-unlock {
    background: linear-gradient(135deg, #FFF5E8 0%, #FFE8D5 100%);
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 20px;
    border: 2px dashed var(--brand-color);
    animation: fragmentReveal 0.8s ease-out 0.3s both;
}

@keyframes fragmentReveal {
    0% { opacity: 0; transform: translateY(20px); }
    100% { opacity: 1; transform: translateY(0); }
}

.fragment-badge {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-bottom: 12px;
}

.fragment-image {
    font-size: 28px;
}

.fragment-label {
    font-size: 12px;
    color: var(--brand-color);
    font-weight: 600;
    letter-spacing: 1px;
    background: rgba(212, 165, 116, 0.15);
    padding: 4px 10px;
    border-radius: 10px;
}

.fragment-text {
    font-size: 14px;
    color: var(--text-color);
    font-style: italic;
    line-height: 1.8;
}

.discovery-progress {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    font-size: 13px;
    color: var(--text-light);
    margin-bottom: 20px;
}

.discovery-progress .progress-icon {
    font-size: 16px;
}

.discovery-continue-btn {
    width: 100%;
    padding: 14px;
    background: linear-gradient(135deg, var(--brand-color) 0%, #C49466 100%);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 16px;
    font-weight: 500;
    letter-spacing: 2px;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 4px 15px rgba(212, 165, 116, 0.4);
}

.discovery-continue-btn:active {
    transform: scale(0.98);
}

/* ========== æå–å¡ï¼ˆé•¿æŒ‰ç‰©å“å¼¹å‡ºï¼‰ ========== */
.extract-card-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.extract-card-modal.visible {
    opacity: 1;
}

.extract-card {
    width: 85%;
    max-width: 320px;
    background: white;
    border-radius: 20px;
    padding: 24px;
    transform: scale(0.9) translateY(20px);
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
}

.extract-card-modal.visible .extract-card {
    transform: scale(1) translateY(0);
}

.extract-header {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin-bottom: 8px;
}

.extract-item-icon {
    font-size: 48px;
}

.extract-item-name {
    font-size: 20px;
    font-weight: 600;
    color: var(--text-color);
}

.extract-desc {
    font-size: 13px;
    color: var(--text-light);
    text-align: center;
    margin-bottom: 20px;
}

.extract-section {
    margin-bottom: 16px;
}

.extract-section-title {
    font-size: 12px;
    font-weight: 600;
    color: var(--brand-color);
    margin-bottom: 8px;
    padding-bottom: 4px;
    border-bottom: 1px dashed var(--brand-color-light);
}

.extract-section-content {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.extract-recipe {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 8px 12px;
    background: #F9F7F2;
    border-radius: 10px;
    font-size: 13px;
}

.recipe-item {
    color: var(--text-color);
}

.recipe-plus {
    color: var(--text-light);
    font-weight: 600;
}

.recipe-result {
    color: var(--brand-color);
    font-weight: 500;
}

.extract-unknown {
    font-size: 12px;
    color: var(--text-light);
    font-style: italic;
    text-align: center;
    padding: 8px;
}

.extract-action-btn {
    width: 100%;
    padding: 14px;
    background: linear-gradient(135deg, #9C88FF 0%, #7B68EE 100%);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 15px;
    font-weight: 500;
    cursor: pointer;
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: transform 0.2s, box-shadow 0.2s;
    box-shadow: 0 4px 15px rgba(156, 136, 255, 0.4);
}

.extract-action-btn:active {
    transform: scale(0.98);
}

.extract-icon {
    font-size: 18px;
}

.extract-close-btn {
    width: 100%;
    padding: 12px;
    background: #f0f0f0;
    color: var(--text-color);
    border: none;
    border-radius: 10px;
    font-size: 14px;
    cursor: pointer;
    transition: background 0.2s;
}

.extract-close-btn:active {
    background: #e0e0e0;
}

/* ========== é™ç½®æ­æ™“ï¼ˆMystery Itemï¼‰ ========== */
.game-item.mystery-item {
    position: relative;
}

.game-item.mystery-item::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255, 255, 255, 0.85);
    border-radius: 50%;
    backdrop-filter: blur(4px);
    animation: mysteryPulse 1.5s ease-in-out infinite;
}

.game-item.mystery-item .icon {
    filter: blur(8px) grayscale(100%);
    opacity: 0.5;
}

.game-item.mystery-item .name {
    filter: blur(4px);
    opacity: 0.3;
}

@keyframes mysteryPulse {
    0%, 100% { opacity: 0.85; }
    50% { opacity: 0.7; }
}

/* æ­æ™“åŠ¨ç”» */
.game-item.revealed-item {
    animation: revealFlash 0.5s ease-out;
}

@keyframes revealFlash {
    0% { 
        transform: scale(1); 
        box-shadow: 0 0 0 0 rgba(212, 165, 116, 0.8);
    }
    50% { 
        transform: scale(1.15); 
        box-shadow: 0 0 30px 10px rgba(212, 165, 116, 0.6);
    }
    100% { 
        transform: scale(1); 
        box-shadow: 0 6px 16px rgba(139, 115, 85, 0.15);
    }
}

/* æå–å‡ºçš„ç‰©å“åŠ¨ç”» */
.game-item.extracted-item {
    animation: extractPop 0.5s ease-out;
}

@keyframes extractPop {
    0% { 
        transform: scale(0) rotate(-180deg); 
        opacity: 0;
    }
    60% { 
        transform: scale(1.2) rotate(10deg); 
    }
    100% { 
        transform: scale(1) rotate(0deg); 
        opacity: 1;
    }
}

/* ========== åŸºç¡€å…³å¡å®Œæˆç”»é¢ ========== */
.basic-completion-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(8px);
    z-index: 1000;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.5s ease-out;
}

.basic-completion-overlay.hidden {
    display: none;
}

.completion-content {
    width: 90%;
    max-width: 400px;
    background: linear-gradient(180deg, #2a2520 0%, #1a1815 100%);
    border-radius: 24px;
    border: 2px solid rgba(212, 165, 116, 0.3);
    padding: 30px 25px;
    text-align: center;
    box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.5),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.completion-section {
    margin-bottom: 25px;
}

.completion-section:last-child {
    margin-bottom: 0;
}

.completion-section.hidden {
    display: none;
}

/* å®Œæˆæ ‡é¢˜ */
.completion-title {
    font-size: 20px;
    font-weight: 500;
    color: #FFE4B5;
    letter-spacing: 2px;
    margin-bottom: 25px;
    text-shadow: 0 2px 10px rgba(255, 215, 0, 0.3);
}

/* ç»Ÿè®¡è¡Œ */
.stats-row {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    margin-bottom: 15px;
    padding: 12px 20px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
}

.stats-label {
    color: rgba(255, 255, 255, 0.6);
    font-size: 14px;
}

.stats-value {
    color: #fff;
    font-size: 18px;
    font-weight: 600;
}

.stats-percent {
    color: rgba(255, 255, 255, 0.6);
    font-size: 14px;
}

/* é€Ÿåº¦è¯„çº§å¾½ç«  */
.speed-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 10px;
    border-radius: 20px;
    font-size: 13px;
    font-weight: 600;
    background: rgba(255, 215, 0, 0.2);
    border: 1px solid rgba(255, 215, 0, 0.4);
}

.speed-badge.tier-5 { /* é—ªç”µ */
    background: rgba(255, 215, 0, 0.2);
    border-color: rgba(255, 215, 0, 0.5);
    color: #FFD700;
}

.speed-badge.tier-4 { /* ç–¾é£ */
    background: rgba(156, 39, 176, 0.2);
    border-color: rgba(156, 39, 176, 0.5);
    color: #CE93D8;
}

.speed-badge.tier-3 { /* ç¨³å¥ */
    background: rgba(33, 150, 243, 0.2);
    border-color: rgba(33, 150, 243, 0.5);
    color: #90CAF9;
}

.speed-badge.tier-2 { /* æ‚ ç„¶ */
    background: rgba(76, 175, 80, 0.2);
    border-color: rgba(76, 175, 80, 0.5);
    color: #A5D6A7;
}

.speed-badge.tier-1 { /* æ²‰æµ¸ */
    background: rgba(158, 158, 158, 0.2);
    border-color: rgba(158, 158, 158, 0.5);
    color: #BDBDBD;
}

.speed-icon {
    font-size: 14px;
}

.speed-name {
    font-size: 12px;
}

/* é¢†å–å¥–åŠ±æŒ‰é’® */
.claim-reward-btn {
    position: relative;
    padding: 15px 50px;
    font-size: 18px;
    font-weight: 600;
    color: #1a1815;
    background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
    border: none;
    border-radius: 30px;
    cursor: pointer;
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
}

.claim-reward-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(255, 215, 0, 0.5);
}

.claim-reward-btn:active {
    transform: translateY(0);
}

.claim-reward-btn .btn-glow {
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(
        45deg,
        transparent 30%,
        rgba(255, 255, 255, 0.4) 50%,
        transparent 70%
    );
    animation: btnShine 3s infinite;
}

@keyframes btnShine {
    0% { transform: translateX(-100%) rotate(45deg); }
    100% { transform: translateX(100%) rotate(45deg); }
}

.btn-text {
    position: relative;
    z-index: 1;
}

/* å¥–åŠ±å±•ç¤º */
.reward-label {
    color: rgba(255, 255, 255, 0.6);
    font-size: 14px;
    margin-bottom: 15px;
}

.reward-content {
    padding: 20px;
    background: rgba(255, 215, 0, 0.1);
    border-radius: 16px;
    border: 1px solid rgba(255, 215, 0, 0.2);
}

.title-upgrade {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    flex-wrap: wrap;
}

.old-title, .new-title {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 8px 16px;
    border-radius: 20px;
}

.old-title {
    background: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.5);
    text-decoration: line-through;
}

.new-title {
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.3) 0%, rgba(255, 167, 38, 0.3) 100%);
    color: #FFE4B5;
    border: 1px solid rgba(255, 215, 0, 0.4);
    animation: newTitleGlow 2s ease-in-out infinite;
}

@keyframes newTitleGlow {
    0%, 100% { box-shadow: 0 0 10px rgba(255, 215, 0, 0.3); }
    50% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.5); }
}

.title-icon {
    font-size: 18px;
}

.title-name {
    font-size: 14px;
    font-weight: 500;
}

.upgrade-arrow {
    color: #FFD700;
    font-size: 20px;
    animation: arrowPulse 1s ease-in-out infinite;
}

@keyframes arrowPulse {
    0%, 100% { opacity: 0.5; transform: translateX(0); }
    50% { opacity: 1; transform: translateX(3px); }
}

/* ç»§ç»­æç¤º */
.continue-message {
    color: rgba(255, 255, 255, 0.7);
    font-size: 15px;
    line-height: 1.8;
    margin-bottom: 25px;
    font-style: italic;
}

.continue-message p {
    margin: 0;
}

.continue-buttons {
    display: flex;
    gap: 15px;
    justify-content: center;
}

.continue-btn {
    padding: 12px 30px;
    font-size: 15px;
    font-weight: 500;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.continue-btn.primary {
    background: linear-gradient(135deg, var(--brand-color) 0%, #C49463 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(212, 165, 116, 0.4);
}

.continue-btn.primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(212, 165, 116, 0.5);
}

.continue-btn.secondary {
    background: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.7);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.continue-btn.secondary:hover {
    background: rgba(255, 255, 255, 0.15);
    color: white;
}

/* å¥–åŠ±å±•ç¤ºåŠ¨ç”» */
.completion-reward-display {
    animation: slideUp 0.5s ease-out;
}

.completion-continue {
    animation: slideUp 0.5s ease-out 0.2s both;
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
